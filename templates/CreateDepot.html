{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Thêm kho</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link rel="stylesheet" href="{% static  'css/bootstrap.min.css'%}" />
    <!-- animate CSS -->
    <link rel="stylesheet" href="{% static 'css/animate.css' %}" />
    <!-- owl carousel CSS -->
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}" />
    <!-- themify CSS -->
    <link rel="stylesheet" href="{% static 'css/themify-icons.css' %}" />
    <!-- flaticon CSS -->
    <link rel="stylesheet" href="{% static 'css/flaticon.css' %}" />
    <!-- font awesome CSS -->
    <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}" />
    <!-- swiper CSS -->
    <link rel="stylesheet" href="{% static 'css/slick.css' %}" />
    <!-- style CSS -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />

    <script src="{% static 'js/jquery-1.12.1.min.js'%}"></script>
    <!-- popper js -->
    <script src="{% static 'js/popper.min.js'%}"></script>
    <!-- bootstrap js -->
    <script src="{% static 'js/bootstrap.min.js'%}"></script>
    <!-- easing js -->
    <script src="{% static 'js/jquery.magnific-popup.js'%}"></script>
    <!-- isotope js -->
    <script src="{% static 'js/isotope.pkgd.min.js'%}"></script>
    <!-- particles js -->
    <script src="{% static 'js/owl.carousel.min.js'%}"></script>
    <script src="{% static 'js/jquery.nice-select.min.js'%}"></script>
    <!-- custom js -->
    <script src="{% static 'js/custom.js' %}"></script>
    <style>
        h2,h5{
            color: WHITE !important;
        }
        .header{
      margin: 18.5px auto;
      display: flex;
      align-items: center;
      max-width: 1259px;
      gap: 200px;
    }

    @media (max-width: 920px) {
      .header{
        gap: 50px;
      }
    }

    @media (max-width: 740px){
      .header img{
        width: 150px;
        height: 100px;
      }
      .header{
        gap: 0px;
        font-size: 12px;
      }
    }

    .map--bin:focus{
      color: #fff !important;
    }
    </style>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.1/dist/leaflet.css"
    integrity="sha256-sA+zWATbFveLLNqWO2gtiw3HL/lh1giY/Inf1BJ0z14=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.1/dist/leaflet.js"
    integrity="sha256-NDI0K41gVbWqfkkaHj15IzU7PtMoelkzyKp8TOaFQ3s=" crossorigin=""></script>
  
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
  <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
</head>
<body onload="initialize()">
  <header class="header">
    <img  src="https://portal.ptit.edu.vn/wp-content/uploads/2016/04/ptit-logo.png" alt="">
    <div>
      <p style="color:#000000;font-size:18px">HỌC VIỆN CÔNG NGHỆ BƯU CHÍNH VIỄN THÔNG</p>
      <p style="color:#D30000;font-size:18px">Posts and Telecommunications Institute of Technology</p>
    </div>
    
  </header>
<section class="banner_part">
  <header class="main_menu home_menu">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-12">
          <nav class="navbar navbar-expand-lg navbar-light">
            <a class="navbar-brand" style="color: WHITE !important;" href="http://127.0.0.1:8000/">
{#                <img src="{% static 'img/logo.png'%}" alt="logo" />#}
                Trang chủ
            </a>
            <button
              class="navbar-toggler"
              type="button"
              data-toggle="collapse"
              data-target="#navbarSupportedContent"
              aria-controls="navbarSupportedContent"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="ti-menu"></span>
            </button>

            <div
              class="collapse navbar-collapse main-menu-item justify-content-center"
              id="navbarSupportedContent"
            >
              <ul class="navbar-nav align-items-center">
                <!-- <li class="nav-item">
                  <a class="nav-link" href="http://127.0.0.1:8000">Home</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'routes' %}">Generate Routes</a>
                </li> -->
                <li class="nav-item">
                  <a class="nav-link" href='{% url 'real_time' %}'>Bản đồ xe</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link map--bin" href='#'>Bản đồ thùng rác</a>
                </li>
                <li class="nav-item dropdown">
                  <a
                    class="nav-link dropdown-toggle"
                    id="navbarDropdown"
                    role="button"
                    data-toggle="dropdown"
                    aria-haspopup="true"
                    aria-expanded="false"
                  >
                    Thêm tài nguyên
                  </a>
                  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="{% url 'create_driver' %}">Thêm lái xe</a>
                    <a class="dropdown-item" href="{% url 'create_bin' %}">Thêm thùng rác</a>
                    <a class="dropdown-item" href="{% url 'create_depot' %}">Thêm kho</a>
                    <a class="dropdown-item" href="{% url 'create_dump' %}">Thêm bãi đổ</a>
                    <a class="dropdown-item" href="{% url 'vehicles' %}">Thêm xe rác</a>
                  </div>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href='{% url 'check' %}'>Xem dữ liệu</a>
                </li>
              </ul>
            </div>

          </nav>
        </div>
      </div>
    </div>
  </header>
      <div class="container">
        <div class="row align-items-center">
          <div class="col-lg-6 offset-lg-1" style="position: relative;top: 80px; margin-left: 0">

<H2>Thêm kho</H2>
<div id="map" style="width: 600px; height: 480px"></div>
<form action="/post_create_depot/" method="post" style="margin-top: 5px">
    {% csrf_token %}
    <h5>Latitude :</h5>
    <input id="lat" type="text" name="lat" value="21.018915" required><br><br>
    <h5>Longitude:</h5>
	<input id="lng" type="text" name="lon" value="105.839723" required><br><br>
    
    <input type="submit" value="Thêm">
</form>
          </div>
        </div>
      </div>
</section>
</body>
<script>
  document.querySelector('.map--bin').addEventListener('click', function(e){
    e.preventDefault();
    window.open('{% url 'latlong' %}');
  })

  function initialize() {
  let map = L.map('map').setView([21.018915, 105.839723], 13);

  let osm = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
  });
  osm.addTo(map)

  googleStreets = L.tileLayer('http://{s}.google.com/vt?lyrs=m&x={x}&y={y}&z={z}',{
    maxZoom: 20,
    subdomains:['mt0','mt1','mt2','mt3']
  });

  let baseMaps = {
    "OSM": osm,
    "Google Street": googleStreets
  }
  
  let marker = {}

  L.control.layers(baseMaps, marker, {collapsed: true}).addTo(map);

  map.on('click', function(e) {        
        lat = e.latlng.lat;
        lon = e.latlng.lng;
        if (marker != undefined) {
              map.removeLayer(marker);
        };
        var myIcon = L.icon({
            iconUrl: "{% static 'img/depot_icon.jpg' %}",
            iconSize: [25, 25],
            // iconAnchor: [22, 94],
            // popupAnchor: [-3, -76],
            // shadowSize: [68, 95],
            // shadowAnchor: [22, 94]
        });
        marker = L.marker([lat,lon], {icon: myIcon}).addTo(map);  
        
        document.getElementById('lat').value = lat.toFixed(6);
        document.getElementById('lng').value = lon.toFixed(6);
    });
  // googleStreets.addTo(map);

  let geocoder = L.Control.geocoder({
    defaultMarkGeocode: false
  })
  .on('markgeocode', function(e) {
    let center = e.geocode.bbox.getCenter();
    map.flyTo(center);
    lat = center.lat;
    lon = center.lng;
    if (marker != undefined) {
              map.removeLayer(marker);
        };
        var myIcon = L.icon({
            iconUrl: "{% static 'img/depot_icon.jpg' %}",
            iconSize: [15, 25],
            // iconAnchor: [22, 94],
            // popupAnchor: [-3, -76],
            // shadowSize: [68, 95],
            // shadowAnchor: [22, 94]
        });
        marker = L.marker([lat,lon], {icon: myIcon}).addTo(map);  
    
        document.getElementById('lat').value = lat.toFixed(6);
        document.getElementById('lng').value = lon.toFixed(6);
  })
  .addTo(map);
}

</script>
</html>